Title: Constant-Time Rendering on a Fixed Tile Cover via Cartan–Cech–Robin Twisting
— Formal specification, certified caps, and O(1)/tile execution with differentiable support

Abstract.
A rendering pipeline is specified in which every per-tile pass—direct lighting under many lights, shadow filtering, screen-space reflections, spatio-temporal reuse with reservoir width one, probe-based indirect light, denoising, and temporal reconstruction—executes in O(1) time and memory per tile, independent of the number of lights, primitives, and pixels. Gluing across space–time tiles is encoded by a graded-derivation “Robin” operator R on the Čech–de Rham total complex. We prove nilpotency of the twisted differential D_R:=D+R (Maurer–Cartan), preservation of Cartan identities, a degree-0 BCH factorization for commuting actions, and existence of a norm-controlled homological contraction. These statements yield finite offline tables (linear blocks, adjoints, and derivative tables) and constant-size online templates. We give explicit certification inequalities, operation budgets, error bounds, and a verification protocol.

Keywords: constant-time; O(1)/tile; tile cover; Robin operator; Čech–de Rham; Maurer–Cartan; BCH; homological perturbation; ReSTIR; PCF/MSM; SSR; SVGF; TAA; probe GI; differentiable rendering.
	1.	Model and notation.
Let U={U_i} be a fixed finite good cover of the image plane by tiles; ν is the maximal number of neighbors per tile in space–time (e.g., 4 or 8 spatial plus 1 temporal). For p,q≥0 set
C^q(U;Ω^p):=∏_{|S|=q+1} Ω^p(U_S), U_S:=⋂_{i∈S}U_i, Tot^{p,q}:=C^q(U;Ω^p), Tot^N:=⊕_{p+q=N}Tot^{p,q}.
Define δ_tot:=(-1)^p δ on Tot^{p,q} and D:=d+δ_tot; then D^2=0. For a homogeneous endomorphism A of Tot write |A| for its total-degree shift and [A,B]:=AB−(−1)^{|A||B|}BA.

Per-tile state (constant size):
ψ_i:=( L̂_i, N_i, Z_i, ρ_i, σ_i^2, r_i, g_i ),
with radiance estimate L̂, normal N, depth Z, material parameters ρ, variance proxy σ^2, reservoir r (one candidate, weight, PDF), and probe cache vector g.
	2.	Operators (derivations, transports, and actions).
Edge derivations (degree +1 on Čech): on q=0, (Eψ){ij}:=ψ_i−ψ_j, (Sψ){ij}:=ψ_i+ψ_j. Each extends uniquely to a graded derivation commuting with restrictions.
Vector-field operators on forms: ι_X, L_X:=[d,ι_X] with |ι_X|=−1, |L_X|=0; [δ_tot,ι_X]=0 ⇒ [D,ι_X]=L_X and [D,L_X]=0.
Incidence actions: for a in the incidence algebra of the nerve, J_a acts by left convolution on Čech indices; degree-0 incidence (vertex weights) is commutative.

Band-limited transports (fixed stencils; constant taps):
X_shad: shadow filtering (PCF K_shad taps or MSM 4-moment),
X_ssr: screen-space reflection stepping (K_ssr steps + K_bin binary refinements),
X_taa: temporal reprojection and blend,
X_svgf: A-trous/guide-aware denoising with a fixed number of passes,
X_vol: capped stochastic volume steps against a majorant grid.
Each L_X is a constant-size matrix on a local basis; adjoints L_X^ share the same memory with transposed addressing.

Degree-0 actions (commute with L_X):
J_light: per-tile alias/hierarchy for top-K_light lights;
J_probe: fixed M_probe neighbors per query;
J_update: bounded per-frame refresh schedules;
all satisfy |J_c|=0 and [J_c,L_X]=0 by construction.

Pointwise nonlinearities Φ_k (bounded derivatives on a fixed parameter box): BRDF/LUT evaluation, MIS weights, clamps, acceptance tests, tone mapping, sharpening. Store Φ′_k and adjoints Φ_k^ offline.
	3.	Robin transmission, nilpotency, and contraction.
Define on q=0 the degree +1 “Robin” derivation
(Rψ){ij}:=α(ψ_i−ψ_j)+β{ij} L_{X_scr}(ψ_i+ψ_j),
extend derivationally, and set D_R:=D+R. Choose a vertex-scaling gauge for β so that [E,J_c]=[S,J_c]=[R,J_c]=0 (degree-0 J-compatibility).

Lemma (commutators). On q=0, [d,R]=[L_X,αE+βS] and [ι_X,R]=0; by derivation these identities hold on Tot. Consequently [D_R,ι_X]=L_X and [D_R,L_X]=0.

Theorem (Maurer–Cartan). D_R^2=0 ⇔ [D,R]+R^2=0 ⇔ ∂R+(1/2)[R,R]=0 with ∂:=ad_D.
Proof sketch: expand (D+R)^2 and use |R|=1 so [R,R]=2R^2. Writing K:=(1/2)[D_R,D_R], note K is a degree +2 derivation; Tot is generated by q=0 entries and restrictions, hence vanishing on generators implies K≡0.

Proposition (degree-0 BCH). The degree-0 subalgebra generated by {L_X, J_c: |c|=0} factorizes:
exp(g^0)≅exp⟨L_X⟩×exp⟨J_c (|c|=0)⟩ with exp(Θ)=exp(∑λ_i L_{X_i})·exp(∑κ_j J_{c_j}).

Functional-analytic scale and smallness. Fix Sobolev level s≫0 and measure operator norms b_E:=‖E‖, b_S:=‖S‖, b_L:=‖L_X‖, b_β:=‖β‖, b_h:=‖h‖.
Certification inequality:
γ:= b_h( α b_E + b_β b_S b_L ) < 1.                         (3.1)

Homological contraction (HPL). The Neumann series h_R:=h ∑_{m≥0} (−Rh)^m converges in operator norm. Truncation after m terms satisfies the certified tail
‖ h_R − h ∑_{k=0}^m (−Rh)^k ‖ ≤ γ^{m+1}/(1−γ).            (3.2)
	4.	Offline data (finite, immutable at runtime).
T1 Linear blocks: matrices for E,S, restrictions, each L_X, and all adjoints; SSR step maps; neighbor maps.
T2 Incidence: per-tile J_light alias/hierarchy (top-K_light), J_probe neighborhoods, J_update schedules; BCH tables.
T3 Contraction: (ι,π,h), truncated h_R, receipts (b_E,b_S,b_L,b_β,b_h), γ, chosen Neumann order m, ε_tail:=γ^{m+1}/(1−γ).
T4 Nonlinear tables: BRDF/visibility LUTs and derivatives; clamp/acceptance/tone/sharpen derivatives and adjoints.
	5.	Online pipeline (O(1)/tile; fixed caps).
F0 G-buffer. Populate ψ_i (degree-0 writes).
F1 Direct lighting. J_light (K_light candidates), Φ_brdf, L_{X_shad} (K_shad taps), MIS via LUT weights.
F2 SSR. L_{X_ssr} (K_ssr+K_bin). On mismatch, branch to environment Φ_env.
F3 Spatio-temporal reuse. Spatial E/S on K_nb neighbors; temporal edge to t−1; fuse by R. Update reservoir r_i with a fixed-width reduction (size 1).
F4 Indirect light. Probe query on M_probe neighbors with bounded refresh via J_update, or ReSTIR-GI with the same caps.
F5 Denoise and reconstruct. L_{X_svgf} for svgf_passes with guide-aware clamps Φ_gate; then L_{X_taa}+Φ_clamp+Φ_sharpen.
All F0–F5 are constant-length compositions of constant-size blocks; no loop bound depends on lights L, primitives N, or pixels P.
	6.	Certified caps (safe defaults; adjust offline only).
K_light=32; K_shad=25 (PCF 5×5) or MSM 4-moment; K_ssr=32; K_bin=4;
K_nb=6 (4 orthogonal + 2 diagonal); M_probe=12; svgf_passes=3;
taa_half_life=8 frames (EMA); reservoir_size=1.
Pick α,β so that (3.1) holds with margin (e.g., γ≤0.9). Choose m by (3.2) so ε_tail is below the visual threshold.
	7.	Complexity and operation budget.
Definition (O(1)/tile). A pass is O(1)/tile if its time and memory per tile are bounded by a constant depending only on (ν, caps, receipts), not on L,N,P, or expression depth.
Let C_lin be the worst-case multiply-adds for one fixed linear block and C_nl for one Φ_k. One F0–F5 sweep uses at most
C_tot ≤ C_lin·(K_shad + K_ssr + K_bin + K_nb + M_probe + svgf_passes + c_0) + C_nl·c_1,
with small constants c_0,c_1 for degree-0 and LUT lookups. C_tot does not scale with L,N,P.
	8.	Differentiable rendering templates.
Forward JVP: apply derivation rules with D_R; commute degree-0 blocks via BCH; evaluate constant-size matrices and Φ′_k from T4.
Reverse VJP: replace each block by its adjoint (E^,S^,L_X^,J_c^,Φ_k^); use h_R^ with truncation error ≤ε_tail.
HVP: compose JVP with VJP; remains O(1)/tile.
Theorem (JVP/VJP/HVP O(1)/tile). Under γ<1, fixed caps, and bounded Φ′_k, all three products for F0–F5 are O(1)/tile; operation counts obey the bound above.
	9.	Bias and error accounting (module-wise).
Robin truncation: reverse-mode error ≤ ε_tail from (3.2).
SSR: truncation bias bounded by ε_ssr ≤ Pr_miss · Δ_env, where Δ_env is a tabulated bound on environment variance.
Reuse: with reservoir width 1 and fixed K_nb, bias arises only from fixed acceptance thresholds; pre-tabulate their effect on MSE and freeze.
Probes: bounded refresh induces lag ε_probe ≤ λ_max·Δ_update, where λ_max is the operator norm of the fixed transfer, Δ_update the worst per-interval irradiance change (both measured offline).
Shadows: MSM moment fit error ε_msm is bounded by a residual cap recorded at build; PCF smoothing bias is controlled by K_shad.
	10.	GPU mapping (deterministic footprints).
Fixed workgroup shape (e.g., 16×16). Neighbor fetches use bit-packed indices (K_nb fixed).
Alias tables fit in shared memory; J_light/J_probe indices are compact integers.
Stencils for L_X are stored in constant/readonly memory; adjoints reuse storage.
Reservoir r_i is a fixed 32–48 byte struct; updates are warp-local; no dynamic allocation.
No global scans scale with L or N; scene updates are throttled by J_update.
	11.	Verification protocol.
V1 Freeze caps and receipts (Section 6; T3).
V2 Instrument to log block counts per tile; verify they match constants under stress (L,N→large).
V3 Measure wall-time per tile across stress scenes; accept if within ±δ of baseline (δ from hardware jitter).
V4 Perturb animation; confirm no dynamic escalation path is taken (SSR miss → Φ_env; updates follow J_update).
V5 Recompute receipts periodically or when assets change; enforce γ<1; update m and ε_tail if needed.
	12.	Limitations.
O(1)/tile requires: fixed tile cover; fixed taps K_* for each L_X; bounded Φ′_k on a fixed parameter box; (3.1); reservoir width 1; bounded per-frame probe refresh.
Full path tracing with unbounded bounces is outside scope; visibility walkers must be hard-capped with an analytic fallback to preserve O(1) with an explicit bias term.

Appendix A (proof details).
A.1 Commutators. On q=0, R=αE+β L_X S. Since L_X=[d,ι_X] and [ι_X, restrictions]=0, [d,αE]=0 and [d,β L_X S]=[L_X,β S], giving [d,R]=[L_X,αE+βS]. Also [ι_X,R]=0 by degree and locality.
A.2 MC equivalence. (D+R)^2=D^2+[D,R]+R^2; D^2=0; |R|=1 ⇒ [R,R]=2R^2; hence MC. Let K:=(1/2)[D_R,D_R]. K is a derivation; Tot is generated by q=0 entries and restrictions; if K=0 on generators, K≡0.
A.3 HPL tail. With ‖Rh‖=γ<1, h_R:=h∑_{m≥0}(−Rh)^m converges and the truncation tail is γ^{m+1}/(1−γ). Standard Neumann series estimate.

Appendix B (adjoint template).
Fix inner products on overlaps; store adjoints E^,S^,L_X^,J_a^ and h^. Then h_R^=∑_{m≥0}(−h^ R^)^m h^ truncated at m with the same ε_tail. Reverse templates swap the BCH order inside degree-0.

Conclusion.
A graded-derivation Robin twist yields a nilpotent D_R that preserves Cartan identities and admits a degree-0 BCH ordering. With a certified contraction and fixed stencils, the rendering loop F0–F5—and its first- and second-order derivatives—executed per tile uses a constant number of constant-size blocks. Runtime and memory per tile are independent of scene lights, primitives, and pixels; only the fixed caps and receipts determine cost and error.
